import{r as l,_ as fe,j as e,c as G,s as K,b as pe,h as ge}from"./index-C88s8bSQ.js";import{A as he}from"./AdminSideBar-DYBrMzSY.js";import{S as ve}from"./SelectCategoryList-tifGI8p7.js";import{I as f,B as je}from"./Input-B77FTipe.js";import{_ as Ne,a as p,h as ye,b as F,c as Se,u as be,d as Ie,S as Oe}from"./SelectBox-CvFg71UL.js";import{f as we}from"./form-ux-gggio.js";import{f as Pe}from"./productApi-Dl9Jr5DU.js";import{g as Ce,N as _e}from"./NavBar-CNJfXYLX.js";import{M as Me}from"./MobileFooter-D7dY_Xl2.js";import{A as Le}from"./Alert-Cm2xwtgk.js";var Ae=["defaultOptions","cacheOptions","loadOptions","options","isLoading","onInputChange","filterOption"];function Ee(s){var i=s.defaultOptions,t=i===void 0?!1:i,d=s.cacheOptions,n=d===void 0?!1:d,r=s.loadOptions;s.options;var c=s.isLoading,u=c===void 0?!1:c,m=s.onInputChange,M=s.filterOption,V=M===void 0?null:M,y=Ne(s,Ae),g=y.inputValue,h=l.useRef(void 0),j=l.useRef(!1),S=l.useState(Array.isArray(t)?t:void 0),L=p(S,2),A=L[0],E=L[1],R=l.useState(typeof g<"u"?g:""),k=p(R,2),B=k[0],b=k[1],J=l.useState(t===!0),a=p(J,2),I=a[0],x=a[1],T=l.useState(void 0),z=p(T,2),O=z[0],w=z[1],$=l.useState([]),q=p($,2),H=q[0],P=q[1],Q=l.useState(!1),D=p(Q,2),U=D[0],v=D[1],le=l.useState({}),Y=p(le,2),C=Y[0],Z=Y[1],ne=l.useState(void 0),ee=p(ne,2),ie=ee[0],de=ee[1],ce=l.useState(void 0),se=p(ce,2),re=se[0],oe=se[1];n!==re&&(Z({}),oe(n)),t!==ie&&(E(Array.isArray(t)?t:void 0),de(t)),l.useEffect(function(){return j.current=!0,function(){j.current=!1}},[]);var W=l.useCallback(function(_,N){if(!r)return N();var o=r(_,N);o&&typeof o.then=="function"&&o.then(N,function(){return N()})},[r]);l.useEffect(function(){t===!0&&W(B,function(_){j.current&&(E(_||[]),x(!!h.current))})},[]);var ue=l.useCallback(function(_,N){var o=ye(_,N,m);if(!o){h.current=void 0,b(""),w(""),P([]),x(!1),v(!1);return}if(n&&C[o])b(o),w(o),P(C[o]),x(!1),v(!1);else{var me=h.current={};b(o),x(!0),v(!O),W(o,function(X){j&&me===h.current&&(h.current=void 0,x(!1),w(o),P(X||[]),v(!1),Z(X?F(F({},C),{},Se({},o,X)):C))})}},[n,W,O,C,m]),xe=U?[]:B&&O?H:A||[];return F(F({},y),{},{options:xe,isLoading:I||u,onInputChange:ue,filterOption:V})}var Be=l.forwardRef(function(s,i){var t=Ee(s),d=be(t);return l.createElement(Ie,fe({ref:i},d))}),ze=Be;const ae=s=>e.jsx(ze,{placeholder:s.placeHolder,className:s.className,defaultValue:s.defaultValue,isDisabled:s.disabled,isLoading:s.isLoading,isClearable:s.isClearable,isRtl:!0,isSearchable:s.isSearchable,name:s.name,noOptionsMessage:()=>e.jsx("div",{children:"موردی یافت نشد  "}),loadOptions:s.loadOptions,isMulti:s.isMulti,styles:{container:i=>({...i,width:s.width}),control:i=>({height:s.height,...i})}}),qe=(s,i,t)=>{const d=s.current.inventoryQuantity.value,n=s.current.inventorySize.value;if(d&&n){const r=i.findIndex(c=>{if(c.size===n)return!0});t(r!==-1?c=>(console.log(c[r]),c[r].quantity=d,JSON.parse(JSON.stringify(c))):c=>(c.push({size:n,quantity:d}),JSON.parse(JSON.stringify(c))))}},De=(s,i,t)=>{const d=i.findIndex(n=>{if(n.size===s)return!0});d!==-1&&t(n=>(n.splice(d,1),JSON.parse(JSON.stringify(n))))},te=async(s,i,t,d,n)=>{try{d(!0);const r=new FormData;r.append("file",s.target.files[0]);const c=await G.post(K+"image/upload",r,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:u=>{const m=Math.round(u.loaded/u.total*100);i(m)}});i(0),d(!1),c.status===200&&(console.log("im uploaded LOL"),t(u=>[...u,c.data.data.image]))}catch(r){console.log("hello"),d(!1),i(0),r.response?(n(()=>r.response.data.fieldErrors),setToastList(c=>{var u,m;return[{type:"danger",message:(m=(u=r.response.data)==null?void 0:u.overallError)==null?void 0:m.message}]})):setToastList(c=>[{type:"danger",message:"در ارتباط با سرور مشکلی پیش امده"}])}},Fe=s=>e.jsx("div",{className:"flex w-full bg-gray-200 rounded-full overflow-hidden  "+s.className,role:"progressbar","aria-valuenow":"25","aria-valuemin":"0","aria-valuemax":"100",children:e.jsx("div",{class:"flex flex-col justify-center rounded-full overflow-hidden bg-blue-300 text-xs text-white text-center whitespace-nowrap transition duration-500 ",style:{width:s.persentage+"%"}})}),Ve=async(s,i)=>{try{const t=await G.get(K+"color/findBy",{params:{colorName:s}});if(t.status===200){const d=t.data.map(n=>({value:n.id,label:n.name}));i(d)}}catch{i([])}},Re=async(s,i)=>{try{const t=await G.get(K+"brand/findBy",{params:{brandName:s}});if(t.status===200){const d=t.data.map(n=>({value:n.id,label:n.name}));i(d)}}catch{i([])}},ke=({errors:s,setErrors:i,setToastList:t})=>{const d=l.useRef(),[n,r]=pe(),[c,u]=l.useState([]),[m,M]=l.useState([]),[V,y]=l.useState(!1),[g,h]=l.useState(!1),[j,S]=l.useState([]),[L,A]=l.useState(0),[E,R]=l.useState(null);l.useEffect(()=>{Ce(R)},[]),l.useEffect(()=>{Pe(n.get("productId"),M)},[]),ge(()=>{try{const a=d.current;a.code.value=product.code,a.code.value=product.code,a.productName.value=product.productName,a.description.value=product.description,a.price.value=product.price,a.offPercent.value=product.offPercent,a.material.value=product.material,a.height.value=product.height,r(I=>{var x;return I.set("categoryId",(x=product==null?void 0:product.mainCategory)==null?void 0:x.id)}),a.brandId.value=product.brandId,a.colorId.value=product.colorId,S(product==null?void 0:product.images,product==null?void 0:product.mainImage),h(product==null?void 0:product.mainImage)}catch{}},[m]);const B=a=>{a.preventDefault(),console.log(d.current.description);const I=a.target.code.value,x=a.target.productName.value,T=a.target.description.value,z=a.target.price.value,O=a.target.offPercent.value,w=a.target.material.value,$=a.target.pattern.value,q=a.target.height.value,H=n.get("categoryId"),P=a.target.brandId.value,Q=a.target.colorId.value,D=j.filter(v=>v.id!==g.id).map(v=>v.id),U=g.id;we(n.get("productId")?"product/admin/update/"+n.get("productId"):"product/admin/save",{code:I,productName:x,description:T,price:z,offPercent:O,material:w,pattern:$,height:q,categoryId:H,brandId:P,colorId:Q,inventories:c,imageIds:D,mainImageId:U},t,i)},b=l.useCallback(Ve),J=l.useCallback(Re);return e.jsxs("form",{onSubmit:B,ref:d,className:"insert-product-form flex flex-col gap-y-10",children:[e.jsxs("div",{className:"flex ",children:[e.jsx("div",{className:"mx-2 self-start",children:e.jsx("i",{class:"fa-solid fa-2x fa-square-plus text-sky-400"})}),e.jsxs("div",{className:"grow flex flex-col gap-y-3",children:[e.jsx("div",{className:" text-lg font-semibold",children:"گام اول: انتخاب گروه کالا"}),e.jsx("div",{className:"mx-3",children:e.jsx(ve,{categories:E})})]})]}),e.jsxs("div",{className:"flex ",children:[e.jsx("div",{className:"mx-2 self-start",children:e.jsx("i",{class:"fa-solid fa-2x fa-square-plus text-emerald-400"})}),e.jsxs("div",{className:"grow flex flex-col gap-y-10",children:[e.jsx("div",{className:" text-lg font-semibold",children:"گام دوم:درج اطلاعات کالا"}),e.jsxs("div",{className:"mx-3 grid grid-cols-12 gap-x-3 gap-y-4 items-center",children:[e.jsxs("div",{className:"flex flex-col col-span-6 ",children:[e.jsxs("div",{className:"mb-2 font-medium text-sm !leading-3 ",children:[e.jsx("span",{className:" text-red-500 text-lg !leading-3 ",children:"*"}),e.jsx("span",{className:"!leading-3",children:"نام فارسی کالا"})]}),e.jsx(f,{iMessage:s==null?void 0:s.productName,name:"productName"})]}),e.jsxs("div",{className:"flex flex-col col-span-3 ",children:[e.jsxs("div",{className:"mb-2 font-medium text-sm !leading-3 ",children:[e.jsx("span",{className:" text-red-500 text-lg !leading-3 ",children:"*"}),e.jsx("span",{className:"!leading-3",children:"قیمت"})]}),e.jsx(f,{iMessage:s==null?void 0:s.price,name:"price"})]}),e.jsxs("div",{className:"flex flex-col col-span-3 ",children:[e.jsx("div",{className:"mb-2 font-medium text-sm !leading-3 ",children:e.jsx("span",{className:"!leading-3",children:"درصد تخفیف"})}),e.jsx(f,{iMessage:s==null?void 0:s.offPercent,name:"offPercent"})]}),e.jsxs("div",{className:"flex flex-col col-span-4 ",children:[e.jsxs("div",{className:"mb-2 font-medium text-sm !leading-3 ",children:[e.jsx("span",{className:" text-red-500 text-lg !leading-3 ",children:"*"}),e.jsx("span",{className:"!leading-3",children:"کد"})]}),e.jsx(f,{iMessage:s==null?void 0:s.code,name:"code"})]}),e.jsxs("div",{className:"flex flex-col col-span-4 ",children:[e.jsxs("div",{className:"mb-2 font-medium text-sm !leading-3 ",children:[e.jsx("span",{className:" text-red-500 text-lg !leading-3 ",children:"*"}),e.jsx("span",{className:"!leading-3",children:"برند"})]}),e.jsx(ae,{loadOptions:J,isSearchable:!0,name:"brandId"})]}),e.jsxs("div",{className:"flex flex-col col-span-4 ",children:[e.jsxs("div",{className:"mb-2 font-medium text-sm !leading-3 ",children:[e.jsx("span",{className:" text-red-500 text-lg !leading-3 ",children:"*"}),e.jsx("span",{className:"!leading-3",children:"رنگ"})]}),e.jsx(ae,{loadOptions:b,isSearchable:!0,name:"colorId"})]}),e.jsxs("div",{className:"flex flex-col col-span-12 ",children:[e.jsxs("div",{className:"mb-2 font-medium text-sm !leading-3 ",children:[e.jsx("span",{className:" text-red-500 text-lg !leading-3 ",children:"*"}),e.jsx("span",{className:"!leading-3",children:"توضیحات"})]}),e.jsx(f,{iMessage:s==null?void 0:s.description,name:"description",type:"textarea"})]})]})]})]}),e.jsxs("div",{className:"flex ",children:[e.jsx("div",{className:"mx-2 self-start",children:e.jsx("i",{class:"fa-solid fa-2x fa-square-plus text-red-400"})}),e.jsxs("div",{className:"grow flex flex-col gap-y-10",children:[e.jsx("div",{className:" text-lg font-semibold",children:"گام سوم:درج ویژگی های کالا"}),e.jsxs("div",{className:"mx-3 grid grid-cols-12 gap-x-3 gap-y-4 items-center",children:[e.jsxs("div",{className:"flex flex-col col-span-4 ",children:[e.jsxs("div",{className:"mb-2 font-medium text-sm !leading-3 ",children:[e.jsx("span",{className:" text-red-500 text-lg !leading-3 ",children:"*"}),e.jsx("span",{className:"!leading-3",children:"جنس"})]}),e.jsx(f,{iMessage:s==null?void 0:s.material,name:"material"})]}),e.jsxs("div",{className:"flex flex-col col-span-4 ",children:[e.jsx("div",{className:"mb-2 font-medium text-sm !leading-3 ",children:e.jsx("span",{className:"!leading-3",children:"طرح"})}),e.jsx(f,{iMessage:s==null?void 0:s.pattern,name:"pattern"})]}),e.jsxs("div",{className:"flex flex-col col-span-4 ",children:[e.jsxs("div",{className:"mb-2 font-medium text-sm !leading-3 ",children:[e.jsx("span",{className:" text-red-500 text-lg !leading-3 ",children:"*"}),e.jsx("span",{className:"!leading-3",children:"قد"})]}),e.jsx(f,{iMessage:s==null?void 0:s.height,name:"height"})]}),e.jsxs("div",{className:"flex flex-col col-span-5 ",children:[e.jsxs("div",{className:"mb-2 font-medium text-sm !leading-3 ",children:[e.jsx("span",{className:" text-red-500 text-lg !leading-3 ",children:"*"}),e.jsx("span",{className:"!leading-3",children:"سایز"})]}),e.jsx(Oe,{name:"inventorySize",options:[{label:"xs",value:"XS"},{label:"sm",value:"S"}]})]}),e.jsxs("div",{className:"flex flex-col col-span-5 ",children:[e.jsxs("div",{className:"mb-2 font-medium text-sm !leading-3 ",children:[e.jsx("span",{className:" text-red-500 text-lg !leading-3 ",children:"*"}),e.jsx("span",{className:"!leading-3",children:"تعداد"})]}),e.jsx(f,{iMessage:s==null?void 0:s.inventoryQuantity,name:"inventoryQuantity",type:"number"})]}),e.jsx("div",{onClick:()=>{qe(d,c,u)},className:"mt-4 cursor-pointer",children:e.jsx("i",{class:"fa-solid fa-circle-plus fa-2x text-green-500"})}),e.jsx("div",{className:" col-span-12 grid grid-cols-12 ",children:c.map(a=>e.jsxs("div",{className:"flex justify-between col-span-4 p-3 border rounded",children:[e.jsxs("div",{children:[e.jsx("span",{children:"سایز:"}),e.jsx("span",{children:a.size})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{children:"تعداد:"}),e.jsx("span",{children:a.quantity})]}),e.jsx("div",{onClick:()=>De(a.size,c,u),className:"flex items-center cursor-pointer",children:e.jsx("i",{class:"fas fa-window-close text-red-500"})})]}))})]})]})]}),e.jsxs("div",{className:"flex ",children:[e.jsx("div",{className:"mx-2 self-start",children:e.jsx("i",{class:"fa-solid fa-2x fa-square-plus text-purple-400"})}),e.jsxs("div",{className:"grow flex flex-col gap-y-10",children:[e.jsx("div",{className:" text-lg font-semibold",children:"گام چهارم: اپلود عکس"}),e.jsx("div",{className:" flex border justify-center items-center border-slate-500 border-dotted rounded-lg p-10 relative",children:V?e.jsxs(e.Fragment,{children:[e.jsx("input",{onChange:a=>te(a,A,S,y),type:"file",name:"productImage",className:" absolute top-0 w-full h-full z-30 opacity-0 hidden"}),e.jsx(Fe,{className:"h-[20px]",persentage:L})]}):e.jsxs(e.Fragment,{children:[" ",e.jsx("input",{onChange:a=>te(a,A,S,y),type:"file",name:"productImage",className:" absolute top-0 w-full h-full z-30 opacity-0"}),e.jsx("i",{class:"fa-thin fa-circle-plus fa-3x text-sky-400"})]})})]})]}),e.jsxs("div",{className:"grow flex flex-col gap-y-10",children:[e.jsx("div",{className:" text-lg font-semibold",children:"تصاویر بارگذاری شده"}),e.jsx("div",{className:" flex flex-col ",children:j.map(a=>e.jsxs("div",{className:"border flex justify-between  items-center  rounded-lg p-10",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("img",{className:"w-[80px]",src:"http://localhost/"+(a==null?void 0:a.filePath)}),e.jsx("span",{className:" text-sm text-slate-400",children:a==null?void 0:a.filePath})]}),e.jsxs("div",{className:"flex justify-around gap-x-4",children:[e.jsx("div",{children:e.jsx("i",{onClick:()=>h(a),"data-mainImage":(g==null?void 0:g.id)===(a==null?void 0:a.id),class:"fa-solid fa-flag data-[mainImage=true]:text-sky-400 text-slate-400 "})}),e.jsx("div",{children:e.jsx("i",{class:"fa-solid fa-trash text-red-400"})})]})]}))})]}),e.jsx(je,{type:"submit",children:"da"})]})},Ye=()=>{const[s,i]=l.useState([]),[t,d]=l.useState([]);return e.jsxs("div",{className:"profile-page",children:[e.jsx(_e,{}),e.jsx("div",{className:" sticky top-24 w-100 h-0  ",children:t==null?void 0:t.map(n=>e.jsx(Le,{duration:5e3,type:n.type,children:n.message}))}),e.jsx(Me,{}),e.jsxs("div",{className:"mx-auto max-w-screen-xl grid grid-cols-7  mt-10",children:[e.jsx("div",{className:"lg:col-span-2 lg:order-1 col-span-12 order-2",children:e.jsx(he,{})}),e.jsx("div",{className:"lg:col-span-5 lg:order-2 order-1 col-span-12 lg:mr-4",children:e.jsx(ke,{errors:s,setErrors:i,setToastList:d})})]})]})};export{Ye as default};
