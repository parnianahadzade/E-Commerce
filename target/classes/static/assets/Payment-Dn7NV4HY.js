import{r as t,A as b,j as e,c as V,s as L,a as M}from"./index-B5K_8oeC.js";import{P}from"./ProductInCartBox-BH35kHX9.js";import{B as H,I as f}from"./Input-Buyegn0d.js";import{f as w}from"./form-CHX7R2_W.js";import{A}from"./Alert-DHZI-b21.js";const I="data:image/svg+xml,%3csvg%20width='136'%20height='36'%20viewBox='0%200%20136%2036'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M112.005%2013C111.423%2013%20111.005%2013.418%20111.005%2014V21C111.005%2022.3628%20110.368%2023%20109.005%2023H100.007V15.5C100.007%2011.2647%2096.7428%208%2092.5083%208H86.0096C85.4045%208%2084.3749%208.01669%2084.01%208.5L82.0104%2011.5C81.6256%2012.0092%2081.8723%2013%2082.5103%2013H92.5083C93.8711%2013%2095.0079%2014.137%2095.0079%2015.5V23H74.0119C73.4294%2023%2073.0121%2023.4176%2073.0121%2024V27C73.0121%2027.5826%2073.4294%2028%2074.0119%2028H78.0111C78.0111%2029.363%2076.3745%2031%2075.0117%2031H66.0134C64.6509%2031%2064.0138%2030.363%2064.0138%2029V19C64.0138%2018.4182%2063.5959%2018%2063.014%2018H60.0146C59.4327%2018%2059.0148%2018.4182%2059.0148%2019V29C59.0148%2033.5%2061.5143%2036%2066.0134%2036H75.0117C79.2462%2036%2083.0102%2032.2353%2083.0102%2028H99.0071C99.588%2028%20100.007%2027.5808%20100.007%2027V26L101.098%2027.3892C101.463%2027.8724%20101.901%2028%20102.506%2028H109.005C113.24%2028%20116.004%2025.2353%20116.004%2021V14C116.004%2013.418%20115.586%2013%20115.004%2013H112.005ZM105.006%2031C104.424%2031%20104.006%2031.4176%20104.006%2032V35C104.006%2035.5826%20104.424%2036%20105.006%2036H113.004C113.587%2036%20114.004%2035.5826%20114.004%2035V32C114.004%2031.4176%20113.587%2031%20113.004%2031H105.006ZM87.0094%2031C86.4271%2031%2086.0096%2031.4176%2086.0096%2032V35C86.0096%2035.5826%2086.4271%2036%2087.0094%2036H90.5087C91.091%2036%2091.5085%2035.5826%2091.5085%2035V32C91.5085%2031.4176%2091.091%2031%2090.5087%2031H87.0094ZM120.003%208C119.421%208%20119.003%208.41803%20119.003%209V12C119.003%2012.5818%20119.421%2013%20120.003%2013H129.001C130.364%2013%20131.001%2013.637%20131.001%2015V21C131.001%2022.3628%20130.364%2023%20129.001%2023H120.003C119.421%2023%20119.003%2023.4178%20119.003%2024V27C119.003%2027.582%20119.421%2028%20120.003%2028H129.001C133.236%2028%20136%2025.2353%20136%2021V15C136%2010.7647%20133.236%208%20129.001%208H120.003ZM42.5179%208L47.5664%201.49549C48.0588%200.9%2047.6354%200%2046.8626%200H43.0217C42.41%200%2041.83%200.273083%2041.44%200.744663L33.0198%2011.5C32.4465%2012.1935%2032.6198%2013%2033.5197%2013H45.0175C47.8788%2013%2050.0165%2015.1381%2050.0165%2018V23H30.0203C28.7378%2023%2028.0207%2022.3453%2028.0207%2021V5C28.0207%204.41823%2027.6026%204%2027.0209%204H24.0215C23.4396%204%2023.0217%204.41823%2023.0217%205V21C23.0217%2025.5%2026.521%2028%2031.0201%2028H54.0157C54.5966%2028%2055.0155%2027.5808%2055.0155%2027V18C55.0155%2012.2657%2050.7505%208%2045.0175%208H42.5179ZM16.023%204C15.4414%204%2015.0232%204.41823%2015.0232%205V21C15.0232%2022.3632%2014.3866%2023%2013.0236%2023H2.02571C1.44386%2023%201.0259%2023.4182%201.0259%2024V27C1.0259%2027.5822%201.44386%2028%202.02571%2028H13.0236C17.5227%2028%2020.0223%2025.5%2020.0223%2021V5C20.0223%204.41823%2019.6043%204%2019.0224%204H16.023ZM3.84313%2018.7288L0.026095%205C-0.130803%204.44289%200.44723%204%201.0259%204H3.68383C4.21517%204%204.7962%204.23056%204.94037%204.74232L9.04094%2018.6329C9.19664%2019.1859%208.84274%2019.6112%208.26844%2019.6112H5.00863C4.46615%2019.6112%203.99009%2019.2507%203.84313%2018.7288Z'%20fill='%23EF394E'/%3e%3c/svg%3e",S=({price:l,setToastList:n,setErrors:a})=>{const{shoppingCart:s}=t.useContext(b);return e.jsxs("div",{className:"lg:w-[300px] w-screen left-0 bg-white  justify-between items-center lg:items-stretch fixed bottom-0 flex lg:flex-col gap-y-4 border p-5 lg:sticky lg:top-[155px]",children:[e.jsxs("div",{className:"lg:flex   hidden justify-between text-neutral-500 font-semibold border-b-2 py-3  ",children:[e.jsx("span",{children:"قیمت کالا ها "}),e.jsxs("div",{children:[e.jsx("span",{className:"ml-1",children:l==null?void 0:l.totalPurePrice}),e.jsx("span",{children:"تومان"})]})]}),e.jsxs("div",{className:"lg:flex hidden justify-between  items-center  font-semibold  border-b-2  py-3   ",children:[e.jsx("span",{children:"هزینه ارسال"}),e.jsxs("div",{children:[e.jsx("span",{className:"ml-1",children:49e3}),e.jsx("span",{children:"تومان"})]})]}),e.jsxs("div",{className:"flex lg:flex-row flex-col justify-between items-center lg:order-none order-2  font-semibold border-b-2 text-neutral-500 py-3    ",children:[e.jsx("span",{children:"قابل پرداخت"}),e.jsxs("div",{children:[e.jsx("span",{className:"ml-1",children:(l==null?void 0:l.totalPrice)+49e3}),e.jsx("span",{children:"تومان"})]})]}),e.jsx(H,{onClick:()=>w("order/save",s,n,a),size:"lg",shape:"rounded-xl",txtColor:"text-rose-500",moreCss:"border-rose-500",children:"تایید و تکمیل سفارش"})]})},E=({setPersonFormModalActive:l,person:n})=>e.jsxs("div",{className:"flex flex-col border rounded-md ml-3 px-7 py-3 mb-3",children:[n?e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"items-center flex ml-3 text-xl",children:e.jsx("i",{class:"fa-regular fa-location-dot"})}),e.jsxs("div",{className:"flex flex-col font-medium",children:[e.jsx("span",{className:" text-neutral-400",children:"آدرس تحویل سفارش"}),e.jsx("span",{className:"font-medium ",children:"بل رسول زاده، خ. سرو، خ. نیلوفر دوم"}),e.jsx("span",{className:" text-neutral-400",children:" پارسا رجبی"})]})]}):e.jsxs("div",{children:[e.jsx("span",{className:"ml-2",children:e.jsx("i",{class:"fa-regular fa-triangle-exclamation"})}),e.jsx("span",{className:" font-semibold text-neutral-500",children:"آدرسی وجود ندارد"})]}),e.jsxs("div",{className:"flex justify-end text-sky-500 font-medium ",children:[e.jsx("span",{onClick:()=>{l(!0)},className:"mx-3 cursor-pointer",children:"ثبت یا ویرایش ادرس"}),e.jsx("span",{children:e.jsx("i",{class:"fa-light fa-angle-left"})})]})]}),k=l=>{const n=t.useRef(),a=t.useRef(),s=i=>{i?(n.current.classList.remove("hidden"),document.body.classList.add("overflow-hidden"),n.current.classList.remove("opa-0"),a.current.classList.remove("scale-0")):(document.body.classList.remove("overflow-hidden"),n.current.classList.add("opa-0"),a.current.classList.add("scale-0"),setTimeout(()=>{n.current.classList.add("hidden")},500))};return t.useEffect(()=>{console.log(l.enable),s(l.enable)},[l.enable]),e.jsx("div",{ref:n,className:"absolute top-0 w-100 h-100vh flex justify-center  bg-opacity-70 bg-black duration-500 z-40      ",children:e.jsxs("div",{ref:a,style:{height:l.height},className:" bg-white modal-content border relative scale-0 duration-500 self-center overflow-y-scroll "+l.className,children:[e.jsx("div",{onClick:()=>{l.setModalActive(!1)},role:"button",className:" dialog-close-btn ",children:e.jsx("i",{class:"fa fa-times","aria-hidden":"true"})}),l.children]})})},Z=({setPersonFormModalActive:l,personFormModalActive:n,person:a,errors:s,setToastList:i,setErrors:p})=>{var h,r;const[v,o]=t.useState();t.useEffect(()=>{o(a)},[a]);const d=c=>{const{name:x,value:u}=c.target;o({...v,[x]:u})},m=c=>{const x=c.target.firstName.value,u=c.target.lastName.value,N=c.target.phoneNumber.value,j=c.target.postalCode.value,g=c.target.addressLine.value;w("person/save",{firstName:x,lastName:u,phoneNumber:N,postalCode:j,addressLine:g},i,p),c.preventDefault()};return e.jsx(k,{setModalActive:l,enable:n,className:"lg:h-[70vh] h-full lg:w-[550px] w-100 p-6 rounded-2xl ",children:e.jsxs("form",{onSubmit:m,className:"flex-col flex gap-y-4",children:[e.jsx("div",{className:"  font-semibold  border-b pb-5 ",children:e.jsx("span",{children:"تکمیل پروفایل"})}),e.jsxs("div",{className:" grid md:grid-cols-2 grid-cols-1 gap-x-2",children:[e.jsxs("div",{className:"flex flex-col gap-y-2",children:[e.jsx("label",{className:"text-neutral-500 mr-2 font-semibold",children:"نام"}),e.jsx(f,{name:"firstName",onChange:d,value:a==null?void 0:a.firstName,iMessage:s==null?void 0:s.firstName})]}),e.jsxs("div",{className:"flex flex-col gap-y-2",children:[e.jsx("label",{className:"text-neutral-500 mr-2 font-semibold",children:"نام خانوادگی"}),e.jsx(f,{name:"lastName",onChange:d,value:a==null?void 0:a.lastName,iMessage:s==null?void 0:s.lastName})]}),e.jsxs("div",{className:"flex flex-col gap-y-2",children:[e.jsx("label",{className:"text-neutral-500 mr-2 font-semibold",children:"شماره موبایل"}),e.jsx(f,{name:"phoneNumber",onChange:d,value:a==null?void 0:a.phoneNumber,iMessage:s==null?void 0:s.phoneNumber})]})]}),e.jsxs("div",{className:"flex flex-col gap-y-2",children:[e.jsx("label",{className:" text-neutral-500 mr-2 font-semibold",children:"کد پستی"}),e.jsx(f,{name:"postalCode",onChange:d,value:(h=a==null?void 0:a.address)==null?void 0:h.postalCode,iMessage:s==null?void 0:s.postalCode})]}),e.jsxs("div",{className:"flex flex-col gap-y-2",children:[e.jsx("label",{className:" text-neutral-500 mr-2 font-semibold",children:"نشانی پستی"}),e.jsx(f,{name:"addressLine",type:"textarea",onChange:d,value:(r=a==null?void 0:a.address)==null?void 0:r.addressLine,iMessage:s==null?void 0:s.addressLine})]}),e.jsx(H,{size:"lg",shape:"rounded-xl",txtColor:"text-rose-500",moreCss:"border-rose-500",children:"ثبت اطلاعات"})]})})},F=async(l,n,a)=>{try{const s=await V.get(L+"person");if(s.status===200){const i=await s.data;l(i)}}catch(s){console.log(s),s!=null&&s.response||(console.log(s),a(i=>[...i,{type:"danger",message:"در ارتباط با سرور مشکلی پیش امده"}]))}},D=()=>{t.useContext(b);const[l,n]=t.useState(null),[a,s]=t.useState(),[i,p]=t.useState(0),[v,o]=t.useState([]),[d,m]=t.useState([]),h=M(),{shoppingCart:r,updateShoppingCart:c,calculatePrice:x}=t.useContext(b),[u,N]=t.useState({totalPurePrice:0,totalPrice:0,totalOff:0}),[j,g]=t.useState(!1);return t.useEffect(()=>{F(n,o,m),c()},[j]),t.useEffect(()=>{x(N)},[r]),e.jsxs("div",{className:"payment-page ",children:[e.jsx("div",{className:" absolute w-100",children:d==null?void 0:d.map(C=>e.jsx(A,{duration:5e3,type:C.type,children:C.message}))}),e.jsx(Z,{setToastList:m,setErrors:o,errors:v,person:l,setPersonFormModalActive:g,personFormModalActive:j}),e.jsxs("div",{className:"mx-auto max-w-screen-xl mt-10 border relative ",children:[e.jsx("div",{className:"flex justify-center p-4  ",children:e.jsx("img",{className:"w-24",src:I})}),e.jsxs("div",{className:" lg:absolute right-0 top-0 p-4 flex items-center font-semibold text-lg ",children:[e.jsx("i",{onClick:()=>h("/cart"),class:"fa-regular fa-arrow-right ml-2 cursor-pointer "}),e.jsx("span",{children:"تکمیل سفارش"})]})]}),e.jsx("div",{className:"mx-auto max-w-screen-xl",children:e.jsxs("div",{className:"flex mt-10 ",children:[e.jsxs("div",{className:"grow",children:[e.jsx(E,{setPersonFormModalActive:g,person:l}),e.jsxs("div",{className:" flex flex-col border rounded-md ml-3 px-7 py-3",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:" font-semibold text-lg",children:"سبد خرید شما"}),e.jsx("div",{children:"three dot"})]}),e.jsxs("span",{className:" text-neutral-500 text-sm",children:[r.length," کالا"]})]}),r.map((C,y)=>e.jsx(P,{versionId:i,setPrices:s,productInCart:{productInCart:C,productInCartIndex:y}},y))]})]}),e.jsx("div",{children:e.jsx(S,{setErrors:o,setToastList:m,price:u})})]})})]})};export{D as default};
